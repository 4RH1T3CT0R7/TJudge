apiVersion: v1
kind: ConfigMap
metadata:
  name: tjudge-config
  namespace: tjudge
  labels:
    app.kubernetes.io/name: tjudge
data:
  # Database configuration
  DB_HOST: "tjudge-postgres"
  DB_PORT: "5432"
  DB_USER: "tjudge"
  DB_NAME: "tjudge"
  DB_SSL_MODE: "disable"
  DB_MAX_CONNECTIONS: "100"
  DB_MAX_IDLE_CONNECTIONS: "10"
  DB_CONN_MAX_LIFETIME: "5m"

  # Redis configuration
  REDIS_HOST: "tjudge-redis"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  REDIS_POOL_SIZE: "100"

  # Server configuration
  SERVER_PORT: "8080"
  METRICS_PORT: "9090"
  ENVIRONMENT: "production"

  # Logging
  LOG_LEVEL: "info"
  LOG_FORMAT: "json"
  LOG_ASYNC: "true"

  # JWT configuration
  JWT_ACCESS_TOKEN_TTL: "15m"
  JWT_REFRESH_TOKEN_TTL: "168h"

  # Worker configuration
  WORKER_MIN: "20"
  WORKER_MAX: "200"
  WORKER_TIMEOUT: "60s"
  WORKER_RETRY_ATTEMPTS: "3"
  WORKER_RETRY_DELAY: "5s"

  # Executor configuration
  EXECUTOR_TIMEOUT: "60s"
  EXECUTOR_DEFAULT_ITERATIONS: "1000"
  EXECUTOR_MEMORY_LIMIT: "256m"
  EXECUTOR_CPU_LIMIT: "1"

  # Rate limiting
  RATE_LIMIT_ENABLED: "true"
  RATE_LIMIT_RPM: "100"

  # CORS
  CORS_ALLOWED_ORIGINS: "https://tjudge.example.com"
  CORS_ALLOWED_METHODS: "GET,POST,PUT,DELETE,OPTIONS"
  CORS_ALLOWED_HEADERS: "Content-Type,Authorization"
