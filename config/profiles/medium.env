# TJudge Performance Profile: MEDIUM
# Target: 4 CPU cores, 8 GB RAM
# Use case: Standard server, mid-tier VPS, modern workstation
#
# Usage:
#   docker-compose -f docker-compose.selfhosted.yml --env-file config/profiles/medium.env up -d
#   OR: make deploy-medium

# =============================================================================
# WORKER POOL
# =============================================================================
WORKER_MIN=2
WORKER_MAX=5
WORKER_QUEUE_SIZE=5000
WORKER_TIMEOUT=60s

# =============================================================================
# EXECUTOR (Match execution)
# =============================================================================
# 512 MiB per container - standard allocation
EXECUTOR_MEMORY_LIMIT=536870912
# 100% of one CPU core
EXECUTOR_CPU_QUOTA=100000
EXECUTOR_PIDS_LIMIT=100
EXECUTOR_TIMEOUT=60s

# =============================================================================
# DATABASE
# =============================================================================
DB_MAX_CONNECTIONS=50
DB_MAX_IDLE=10
DB_MAX_LIFETIME=5m

# =============================================================================
# REDIS
# =============================================================================
REDIS_POOL_SIZE=50
REDIS_MAXMEMORY=512mb

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPM=100
RATE_LIMIT_BURST=200

# =============================================================================
# RESOURCE LIMITS (Docker Compose deploy)
# =============================================================================
API_CPU_LIMIT=2.0
API_MEMORY_LIMIT=1G
API_MEMORY_RESERVATION=512M

WORKER_CPU_LIMIT=3.0
WORKER_MEMORY_LIMIT=2G
WORKER_MEMORY_RESERVATION=1G

POSTGRES_MEMORY_LIMIT=1G
POSTGRES_MEMORY_RESERVATION=512M
