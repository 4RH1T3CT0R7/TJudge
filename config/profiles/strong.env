# TJudge Performance Profile: STRONG
# Target: 8+ CPU cores, 16+ GB RAM
# Use case: Dedicated server, high-tier VPS, production deployment
#
# Usage:
#   docker-compose -f docker-compose.selfhosted.yml --env-file config/profiles/strong.env up -d
#   OR: make deploy-strong

# =============================================================================
# WORKER POOL
# =============================================================================
WORKER_MIN=5
WORKER_MAX=20
WORKER_QUEUE_SIZE=10000
WORKER_TIMEOUT=60s

# =============================================================================
# EXECUTOR (Match execution)
# =============================================================================
# 1 GiB per container - generous allocation for complex programs
EXECUTOR_MEMORY_LIMIT=1073741824
# 200% CPU (2 cores per container)
EXECUTOR_CPU_QUOTA=200000
EXECUTOR_PIDS_LIMIT=200
EXECUTOR_TIMEOUT=60s

# =============================================================================
# DATABASE
# =============================================================================
DB_MAX_CONNECTIONS=100
DB_MAX_IDLE=20
DB_MAX_LIFETIME=5m

# =============================================================================
# REDIS
# =============================================================================
REDIS_POOL_SIZE=100
REDIS_MAXMEMORY=1gb

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPM=200
RATE_LIMIT_BURST=500

# =============================================================================
# RESOURCE LIMITS (Docker Compose deploy)
# =============================================================================
API_CPU_LIMIT=4.0
API_MEMORY_LIMIT=2G
API_MEMORY_RESERVATION=1G

WORKER_CPU_LIMIT=6.0
WORKER_MEMORY_LIMIT=4G
WORKER_MEMORY_RESERVATION=2G

POSTGRES_MEMORY_LIMIT=2G
POSTGRES_MEMORY_RESERVATION=1G
